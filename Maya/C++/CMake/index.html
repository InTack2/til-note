<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="author" content="InTack2">
    <link rel="canonical" href="https://intack2.github.io/til-note/Maya/C%2B%2B/CMake/">
    <link rel="shortcut icon" href="../../../img/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>CMakeによるプラグインビルド環境構築 - Tack Til Note.</title>
    <link href="../../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../../css/highlight.css">
    <link href="../../../stylesheets/extra.css" rel="stylesheet">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../../js/jquery-3.2.1.min.js"></script>
    <script src="../../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "CMake\u306b\u3088\u308b\u30d7\u30e9\u30b0\u30a4\u30f3\u30d3\u30eb\u30c9\u74b0\u5883\u69cb\u7bc9", url: "#_top", children: [
              {title: "\u6982\u8981", url: "#_1" },
              {title: "\u65b9\u91dd(2021/02/13 \u8ffd\u8a18)", url: "#20210213" },
              {title: "\u624b\u9806", url: "#_2" },
              {title: "\u958b\u767a\u6642", url: "#_4" },
              {title: "\u4ee5\u4e0b\u4ee5\u524d\u81ea\u4f5c\u3057\u3066\u3044\u305fCMake\u30d5\u30a1\u30a4\u30eb", url: "#cmake_1" },
              {title: "\u30d5\u30a1\u30a4\u30eb\u69cb\u6210", url: "#_5" },
              {title: "CMake\u30b3\u30de\u30f3\u30c9", url: "#cmake_2" },
              {title: "\u53c2\u8003", url: "#_6" },
          ]},
        ];

    </script>
    <script src="../../../js/base.js"></script>
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-165693276-2', 'auto');
        ga('send', 'pageview');
    </script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../../../Memo/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../../../Memo/" class="btn btn-xs btn-link">
        Index
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../../%E8%A8%AD%E5%AE%9A%E9%96%A2%E9%80%A3/Site-Packages/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../../%E8%A8%AD%E5%AE%9A%E9%96%A2%E9%80%A3/Site-Packages/" class="btn btn-xs btn-link">
        Maya環境は汚さずにPythonライブラリを使用する。
      </a>
    </div>
    
  </div>

    

    <h1 id="cmake">CMakeによるプラグインビルド環境構築<a class="headerlink" href="#cmake" title="Permanent link">&para;</a></h1>
<h2 id="_1">概要<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h2>
<p>C++はWindowsやLinux、MacなどOSごとにコンパイルする必要がある。<br />
MayaだとWindowsはVS、Linuxはgccなどになります。<br />
MayaのpluginもそれぞれのOSに合わせてビルドが必要になる為、その都度環境を作成して行くのは大変な為、CMakeを活用します。  </p>
<h2 id="20210213">方針(2021/02/13 追記)<a class="headerlink" href="#20210213" title="Permanent link">&para;</a></h2>
<p>基本的に自前でcmakeファイルを用意して行うよりも、<br />
対応する「devkit」を利用した方が一貫性がありおすすめなので、内容を変更しました。</p>
<h2 id="_2">手順<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h2>
<h3 id="mayadevkit">Mayaの対応するdevkitをダウンロードする<a class="headerlink" href="#mayadevkit" title="Permanent link">&para;</a></h3>
<p><a href="https://www.autodesk.com/developer-network/platform-technologies/maya?_ga=2.22332605.720544780.1613183323-906704681.1609486821">こちらからダウンロード</a></p>
<p>下記の様にわかりやすい所に配置します。<br />
<a href="https://gyazo.com/0493a0dd6e526a31ce92bd6155454da2"><img alt="Image from Gyazo" src="https://i.gyazo.com/0493a0dd6e526a31ce92bd6155454da2.png" /></a></p>
<h3 id="_3">配置した場所への環境変数を設定する<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h3>
<p>下記の様に配置した場所へのパスを「DEVKIT_LOCATION」として設定します。<br />
<a href="https://gyazo.com/f953bbfeddc4f75752e12cd34b85ac94"><img alt="Image from Gyazo" src="https://i.gyazo.com/f953bbfeddc4f75752e12cd34b85ac94.png" /></a></p>
<h2 id="_4">開発時<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h2>
<p>あとは実際に開発する際に下記の様な「CMakeLists.txt」を用意して完了です。
<div class="highlight"><pre><span></span><code>cmake_minimum_required(VERSION 2.8)

# 先ほど追加したDEVKIT_LOCATION内のplugin用cmakeファイルを利用する。
include($ENV{DEVKIT_LOCATION}/cmake/pluginEntry.cmake)

set(PROJECT_NAME &quot;プロジェクト名&quot;)

# CMakeに含めるファイル指定
file(GLOB SOURCE_FILES
   ${CMAKE_SOURCE_DIR}/src/*.h
   ${CMAKE_SOURCE_DIR}/src/*.hpp
   ${CMAKE_SOURCE_DIR}/src/*.cpp
   )

# ライブラリを指定
set(LIBRARIES
     OpenMaya
     Foundation

)

set_property( DIRECTORY PROPERTY VS_STARTUP_PROJECT ${PROJECT_NAME})

# Build plugin
build_plugin()
set_target_properties(${PROJECT_NAME} PROPERTIES VS_DEBUGGER_COMMAND &quot;maya.exe&quot;)
set_target_properties(${PROJECT_NAME} PROPERTIES LINK_FLAGS &quot;/export:initializePlugin /export:uninitializePlugin&quot;)
set(CMAKE_CXX_FLAGS_DEBUG &quot;/ZI&quot;)
</code></pre></div></p>
<p>詳しいファイル構成などは下記をご参照ください。<br />
<a href="https://github.com/InTack2/maya-aim-constraint-node"><img src="https://github-link-card.s3.ap-northeast-1.amazonaws.com/InTack2/maya-aim-constraint-node.png" width="460px"></a></p>
<h2 id="cmake_1">以下以前自作していたCMakeファイル<a class="headerlink" href="#cmake_1" title="Permanent link">&para;</a></h2>
<p>既に利用していませんが、一応残しておきます  </p>
<h2 id="_5">ファイル構成<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h2>
<p>ルート<br />
└build<br />
└modules<br />
　└FindMaya.cmake<br />
└CMakeLists.txt(1個目)<br />
└src<br />
　└helloWorldCmd.cpp<br />
　└CMakeLists.txt(2個目)  </p>
<h3 id="findmayacmake">FindMaya.cmake<a class="headerlink" href="#findmayacmake" title="Permanent link">&para;</a></h3>
<p>Maya用にCMakeモジュールを作成する。<br />
Mayaバージョンの指定、OSごとに拡張子の変更、読み込む内容の変更の分岐を記載する。<br />
のちほどコメント追加予定。  </p>
<div class="admonition example">
<p class="admonition-title">FindMaya.cmake</p>
<div class="highlight"><pre><span></span><code><span class="cp"># Set a default Maya version if not specified</span>
<span class="k">if</span><span class="p">(</span><span class="n">NOT</span> <span class="n">DEFINED</span> <span class="n">MAYA_VERSION</span><span class="p">)</span>
    <span class="n">set</span><span class="p">(</span><span class="n">MAYA_VERSION</span> <span class="mi">2020</span> <span class="n">CACHE</span> <span class="n">STRING</span> <span class="s">&quot;Maya version&quot;</span><span class="p">)</span>
<span class="n">endif</span><span class="p">()</span>

<span class="cp"># OS Specific environment setup</span>
<span class="n">set</span><span class="p">(</span><span class="n">MAYA_COMPILE_DEFINITIONS</span> <span class="s">&quot;REQUIRE_IOSTREAM;_BOOL&quot;</span><span class="p">)</span>
<span class="n">set</span><span class="p">(</span><span class="n">MAYA_INSTALL_BASE_SUFFIX</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
<span class="n">set</span><span class="p">(</span><span class="n">MAYA_TARGET_TYPE</span> <span class="n">LIBRARY</span><span class="p">)</span>
<span class="k">if</span><span class="p">(</span><span class="n">WIN32</span><span class="p">)</span>
    <span class="cp"># Windows</span>
    <span class="n">set</span><span class="p">(</span><span class="n">MAYA_INSTALL_BASE_DEFAULT</span> <span class="s">&quot;C:/Program Files/Autodesk&quot;</span><span class="p">)</span>
    <span class="n">set</span><span class="p">(</span><span class="n">MAYA_COMPILE_DEFINITIONS</span> <span class="s">&quot;${MAYA_COMPILE_DEFINITIONS};NT_PLUGIN&quot;</span><span class="p">)</span>
    <span class="n">set</span><span class="p">(</span><span class="n">MAYA_PLUGIN_EXTENSION</span> <span class="s">&quot;.mll&quot;</span><span class="p">)</span>
    <span class="n">set</span><span class="p">(</span><span class="n">MAYA_TARGET_TYPE</span> <span class="n">RUNTIME</span><span class="p">)</span>
<span class="n">elseif</span><span class="p">(</span><span class="n">APPLE</span><span class="p">)</span>
    <span class="cp"># Apple</span>
    <span class="n">set</span><span class="p">(</span><span class="n">MAYA_INSTALL_BASE_DEFAULT</span> <span class="o">/</span><span class="n">Applications</span><span class="o">/</span><span class="n">Autodesk</span><span class="p">)</span>
    <span class="n">set</span><span class="p">(</span><span class="n">MAYA_COMPILE_DEFINITIONS</span> <span class="s">&quot;${MAYA_COMPILE_DEFINITIONS};OSMac_&quot;</span><span class="p">)</span>
    <span class="n">set</span><span class="p">(</span><span class="n">MAYA_PLUGIN_EXTENSION</span> <span class="s">&quot;.bundle&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">()</span>
    <span class="cp"># Linux</span>
    <span class="n">set</span><span class="p">(</span><span class="n">MAYA_COMPILE_DEFINITIONS</span> <span class="s">&quot;${MAYA_COMPILE_DEFINITIONS};LINUX&quot;</span><span class="p">)</span>
    <span class="n">set</span><span class="p">(</span><span class="n">MAYA_INSTALL_BASE_DEFAULT</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">autodesk</span><span class="p">)</span>
    <span class="k">if</span><span class="p">(</span><span class="n">MAYA_VERSION</span> <span class="n">LESS</span> <span class="mi">2016</span><span class="p">)</span>
        <span class="cp"># Pre Maya 2016 on Linux</span>
        <span class="n">set</span><span class="p">(</span><span class="n">MAYA_INSTALL_BASE_SUFFIX</span> <span class="o">-</span><span class="n">x64</span><span class="p">)</span>
    <span class="n">endif</span><span class="p">()</span>
    <span class="n">set</span><span class="p">(</span><span class="n">MAYA_PLUGIN_EXTENSION</span> <span class="s">&quot;.so&quot;</span><span class="p">)</span>
<span class="n">endif</span><span class="p">()</span>

<span class="n">set</span><span class="p">(</span><span class="n">MAYA_INSTALL_BASE_PATH</span> <span class="n">$</span><span class="p">{</span><span class="n">MAYA_INSTALL_BASE_DEFAULT</span><span class="p">}</span> <span class="n">CACHE</span> <span class="n">STRING</span>
    <span class="s">&quot;Root path containing your maya installations, e.g. /usr/autodesk or /Applications/Autodesk/&quot;</span><span class="p">)</span>

<span class="n">set</span><span class="p">(</span><span class="n">MAYA_LOCATION</span> <span class="n">$</span><span class="p">{</span><span class="n">MAYA_INSTALL_BASE_PATH</span><span class="p">}</span><span class="o">/</span><span class="n">maya$</span><span class="p">{</span><span class="n">MAYA_VERSION</span><span class="p">}</span><span class="n">$</span><span class="p">{</span><span class="n">MAYA_INSTALL_BASE_SUFFIX</span><span class="p">})</span>

<span class="cp"># Maya include directory</span>
<span class="n">find_path</span><span class="p">(</span><span class="n">MAYA_INCLUDE_DIR</span> <span class="n">maya</span><span class="o">/</span><span class="n">MFn</span><span class="p">.</span><span class="n">h</span>
    <span class="n">PATHS</span>
        <span class="n">$</span><span class="p">{</span><span class="n">MAYA_LOCATION</span><span class="p">}</span>
        <span class="n">$ENV</span><span class="p">{</span><span class="n">MAYA_LOCATION</span><span class="p">}</span>
    <span class="n">PATH_SUFFIXES</span>
        <span class="s">&quot;include/&quot;</span>
        <span class="s">&quot;devkit/include/&quot;</span>
<span class="p">)</span>

<span class="n">find_library</span><span class="p">(</span><span class="n">MAYA_LIBRARY</span>
    <span class="n">NAMES</span> 
        <span class="n">OpenMaya</span>
    <span class="n">PATHS</span>
        <span class="n">$</span><span class="p">{</span><span class="n">MAYA_LOCATION</span><span class="p">}</span>
        <span class="n">$ENV</span><span class="p">{</span><span class="n">MAYA_LOCATION</span><span class="p">}</span>
    <span class="n">PATH_SUFFIXES</span>
        <span class="s">&quot;lib/&quot;</span>
        <span class="s">&quot;Maya.app/Contents/MacOS/&quot;</span>
    <span class="n">NO_DEFAULT_PATH</span>
<span class="p">)</span>
<span class="n">set</span><span class="p">(</span><span class="n">MAYA_LIBRARIES</span> <span class="s">&quot;${MAYA_LIBRARY}&quot;</span><span class="p">)</span>

<span class="n">include</span><span class="p">(</span><span class="n">FindPackageHandleStandardArgs</span><span class="p">)</span>
<span class="n">find_package_handle_standard_args</span><span class="p">(</span><span class="n">Maya</span>
    <span class="n">REQUIRED_VARS</span> <span class="n">MAYA_INCLUDE_DIR</span> <span class="n">MAYA_LIBRARY</span><span class="p">)</span>
<span class="n">mark_as_advanced</span><span class="p">(</span><span class="n">MAYA_INCLUDE_DIR</span> <span class="n">MAYA_LIBRARY</span><span class="p">)</span>

<span class="k">if</span> <span class="p">(</span><span class="n">NOT</span> <span class="n">TARGET</span> <span class="n">Maya</span><span class="o">::</span><span class="n">Maya</span><span class="p">)</span>
    <span class="n">add_library</span><span class="p">(</span><span class="n">Maya</span><span class="o">::</span><span class="n">Maya</span> <span class="n">UNKNOWN</span> <span class="n">IMPORTED</span><span class="p">)</span>
    <span class="n">set_target_properties</span><span class="p">(</span><span class="n">Maya</span><span class="o">::</span><span class="n">Maya</span> <span class="n">PROPERTIES</span>
        <span class="n">INTERFACE_COMPILE_DEFINITIONS</span> <span class="s">&quot;${MAYA_COMPILE_DEFINITIONS}&quot;</span>
        <span class="n">INTERFACE_INCLUDE_DIRECTORIES</span> <span class="s">&quot;${MAYA_INCLUDE_DIR}&quot;</span>
        <span class="n">IMPORTED_LOCATION</span> <span class="s">&quot;${MAYA_LIBRARY}&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">APPLE</span> <span class="n">AND</span> <span class="n">$</span><span class="p">{</span><span class="n">CMAKE_CXX_COMPILER_ID</span><span class="p">}</span> <span class="n">MATCHES</span> <span class="s">&quot;Clang&quot;</span> <span class="n">AND</span> <span class="n">MAYA_VERSION</span> <span class="n">LESS</span> <span class="mi">2017</span><span class="p">)</span>
        <span class="cp"># Clang and Maya 2016 and older needs to use libstdc++</span>
        <span class="n">set_target_properties</span><span class="p">(</span><span class="n">Maya</span><span class="o">::</span><span class="n">Maya</span> <span class="n">PROPERTIES</span>
            <span class="n">INTERFACE_COMPILE_OPTIONS</span> <span class="s">&quot;-std=c++0x;-stdlib=libstdc++&quot;</span><span class="p">)</span>
    <span class="n">endif</span> <span class="p">()</span>
<span class="n">endif</span><span class="p">()</span>

<span class="cp"># Add the other Maya libraries into the main Maya::Maya library</span>
<span class="n">set</span><span class="p">(</span><span class="n">_MAYA_LIBRARIES</span> <span class="n">OpenMayaAnim</span> <span class="n">OpenMayaFX</span> <span class="n">OpenMayaRender</span> <span class="n">OpenMayaUI</span> <span class="n">Foundation</span> <span class="n">clew</span><span class="p">)</span>
<span class="n">foreach</span><span class="p">(</span><span class="n">MAYA_LIB</span> <span class="n">$</span><span class="p">{</span><span class="n">_MAYA_LIBRARIES</span><span class="p">})</span>
    <span class="n">find_library</span><span class="p">(</span><span class="n">MAYA_$</span><span class="p">{</span><span class="n">MAYA_LIB</span><span class="p">}</span><span class="n">_LIBRARY</span>
        <span class="n">NAMES</span> 
            <span class="n">$</span><span class="p">{</span><span class="n">MAYA_LIB</span><span class="p">}</span>
        <span class="n">PATHS</span>
            <span class="n">$</span><span class="p">{</span><span class="n">MAYA_LOCATION</span><span class="p">}</span>
            <span class="n">$ENV</span><span class="p">{</span><span class="n">MAYA_LOCATION</span><span class="p">}</span>
        <span class="n">PATH_SUFFIXES</span>
            <span class="s">&quot;lib/&quot;</span>
            <span class="s">&quot;Maya.app/Contents/MacOS/&quot;</span>
        <span class="n">NO_DEFAULT_PATH</span><span class="p">)</span>
    <span class="n">mark_as_advanced</span><span class="p">(</span><span class="n">MAYA_$</span><span class="p">{</span><span class="n">MAYA_LIB</span><span class="p">}</span><span class="n">_LIBRARY</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">MAYA_$</span><span class="p">{</span><span class="n">MAYA_LIB</span><span class="p">}</span><span class="n">_LIBRARY</span><span class="p">)</span>
        <span class="n">add_library</span><span class="p">(</span><span class="n">Maya</span><span class="o">::</span><span class="n">$</span><span class="p">{</span><span class="n">MAYA_LIB</span><span class="p">}</span> <span class="n">UNKNOWN</span> <span class="n">IMPORTED</span><span class="p">)</span>
        <span class="n">set_target_properties</span><span class="p">(</span><span class="n">Maya</span><span class="o">::</span><span class="n">$</span><span class="p">{</span><span class="n">MAYA_LIB</span><span class="p">}</span> <span class="n">PROPERTIES</span>
            <span class="n">IMPORTED_LOCATION</span> <span class="s">&quot;${MAYA_${MAYA_LIB}_LIBRARY}&quot;</span><span class="p">)</span>
        <span class="n">set_property</span><span class="p">(</span><span class="n">TARGET</span> <span class="n">Maya</span><span class="o">::</span><span class="n">Maya</span> <span class="n">APPEND</span> <span class="n">PROPERTY</span>
            <span class="n">INTERFACE_LINK_LIBRARIES</span> <span class="n">Maya</span><span class="o">::</span><span class="n">$</span><span class="p">{</span><span class="n">MAYA_LIB</span><span class="p">})</span>
        <span class="n">set</span><span class="p">(</span><span class="n">MAYA_LIBRARIES</span> <span class="n">$</span><span class="p">{</span><span class="n">MAYA_LIBRARIES</span><span class="p">}</span> <span class="s">&quot;${MAYA_${MAYA_LIB}_LIBRARY}&quot;</span><span class="p">)</span>
    <span class="n">endif</span><span class="p">()</span>
<span class="n">endforeach</span><span class="p">()</span>

<span class="n">function</span><span class="p">(</span><span class="n">MAYA_PLUGIN</span> <span class="n">_target</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">WIN32</span><span class="p">)</span>
        <span class="n">set_target_properties</span><span class="p">(</span><span class="n">$</span><span class="p">{</span><span class="n">_target</span><span class="p">}</span> <span class="n">PROPERTIES</span>
            <span class="n">LINK_FLAGS</span> <span class="s">&quot;/export:initializePlugin /export:uninitializePlugin&quot;</span><span class="p">)</span>
    <span class="n">endif</span><span class="p">()</span>
    <span class="n">set_target_properties</span><span class="p">(</span><span class="n">$</span><span class="p">{</span><span class="n">_target</span><span class="p">}</span> <span class="n">PROPERTIES</span>
        <span class="n">PREFIX</span> <span class="s">&quot;&quot;</span>
        <span class="n">SUFFIX</span> <span class="n">$</span><span class="p">{</span><span class="n">MAYA_PLUGIN_EXTENSION</span><span class="p">})</span>
<span class="n">endfunction</span><span class="p">()</span>
</code></pre></div>
</div>
<h3 id="cmakeliststxt1">CMakeLists.txt(1個目)<a class="headerlink" href="#cmakeliststxt1" title="Permanent link">&para;</a></h3>
<div class="admonition example">
<p class="admonition-title">CMakeLists.txt</p>
<div class="highlight"><pre><span></span><code><span class="n">cmake_minimum_required</span><span class="p">(</span><span class="n">VERSION</span> <span class="mf">2.8</span><span class="p">)</span>
<span class="cp"># specify project name</span>
<span class="n">set</span><span class="p">(</span><span class="n">PROJECT_NAME</span> <span class="n">helloWorldCmd</span><span class="p">)</span>

<span class="n">set</span><span class="p">(</span><span class="n">CMAKE_MODULE_PATH</span> <span class="n">$</span><span class="p">{</span><span class="n">CMAKE_CURRENT_SOURCE_DIR</span><span class="p">}</span><span class="o">/</span><span class="n">modules</span><span class="p">)</span>
<span class="n">set_property</span><span class="p">(</span><span class="n">DIRECTORY</span> <span class="n">$</span><span class="p">{</span><span class="n">CMAKE_CURRENT_SOURCE_DIR</span><span class="p">}</span> <span class="n">PROPERTY</span> <span class="n">VS_STARTUP_PROJECT</span> <span class="n">$</span><span class="p">{</span><span class="n">PROJECT_NAME</span><span class="p">})</span>
<span class="n">add_subdirectory</span><span class="p">(</span><span class="n">src</span><span class="p">)</span>
</code></pre></div>
</div>
<h3 id="cmakeliststxt2">CMakeLists.txt(2個目)<a class="headerlink" href="#cmakeliststxt2" title="Permanent link">&para;</a></h3>
<div class="admonition example">
<p class="admonition-title">CMakeLists.txt</p>
<div class="highlight"><pre><span></span><code><span class="cp"># set SOURCE_FILES</span>
<span class="n">set</span><span class="p">(</span><span class="n">SOURCE_FILES</span>
<span class="n">helloWorldCmd</span><span class="p">.</span><span class="n">cpp</span>
<span class="p">)</span>

<span class="n">find_package</span><span class="p">(</span><span class="n">Maya</span> <span class="n">REQUIRED</span><span class="p">)</span>

<span class="n">include_directories</span><span class="p">(</span><span class="n">$</span><span class="p">{</span><span class="n">MAYA_INCLUDE_DIR</span><span class="p">})</span>
<span class="n">link_directories</span><span class="p">(</span><span class="n">$</span><span class="p">{</span><span class="n">MAYA_LIBRARIES</span><span class="p">})</span>

<span class="n">add_library</span><span class="p">(</span><span class="n">$</span><span class="p">{</span><span class="n">PROJECT_NAME</span><span class="p">}</span> <span class="n">SHARED</span> <span class="n">$</span><span class="p">{</span><span class="n">SOURCE_FILES</span><span class="p">})</span>
<span class="n">target_link_libraries</span><span class="p">(</span><span class="n">$</span><span class="p">{</span><span class="n">PROJECT_NAME</span><span class="p">}</span> <span class="n">$</span><span class="p">{</span><span class="n">MAYA_LIBRARIES</span><span class="p">})</span>

<span class="n">set_target_properties</span><span class="p">(</span><span class="n">$</span><span class="p">{</span><span class="n">PROJECT_NAME</span><span class="p">}</span> <span class="n">PROPERTIES</span>
    <span class="n">VS_DEBUGGER_COMMAND</span> <span class="s">&quot;maya.exe&quot;</span><span class="p">)</span>

<span class="n">MAYA_PLUGIN</span><span class="p">(</span><span class="n">$</span><span class="p">{</span><span class="n">PROJECT_NAME</span><span class="p">})</span>
</code></pre></div>
</div>
<h2 id="cmake_2">CMakeコマンド<a class="headerlink" href="#cmake_2" title="Permanent link">&para;</a></h2>
<h3 id="visual-studio2019">Visual Studio2019の構成を作成<a class="headerlink" href="#visual-studio2019" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span> build
cmake -G <span class="s2">&quot;Visual Studio 16 2019&quot;</span> -DMAYA_VERSION<span class="o">=</span><span class="m">2020</span> ../
</code></pre></div>
<h3 id="debug">プラグインをDebugビルドする<a class="headerlink" href="#debug" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span> build
cmake --build . --config Debug
</code></pre></div>
<h3 id="release">プラグインをReleaseビルドする<a class="headerlink" href="#release" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span> build
cmake --build . --config Release
</code></pre></div>
<h2 id="_6">参考<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h2>
<p><a href="https://qiita.com/mrk_21/items/ab32a83a12f5d37acc64">CMake: モジュール</a><br />
<a href="https://www.qoosky.io/techs/814fda555d">cmake チートシート</a>  </p>

  <br>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../../../Memo/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../../../Memo/" class="btn btn-xs btn-link">
        Index
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../../%E8%A8%AD%E5%AE%9A%E9%96%A2%E9%80%A3/Site-Packages/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../../%E8%A8%AD%E5%AE%9A%E9%96%A2%E9%80%A3/Site-Packages/" class="btn btn-xs btn-link">
        Maya環境は汚さずにPythonライブラリを使用する。
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="container-fluid wm-page-content">
      <p>
        <a href="https://github.com/InTack2/til-note">InTack2/til-note</a>
      </p>
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="https://github.com/gristlabs/mkdocs-windmill">Windmill</a> theme by Grist Labs.</p>
</footer>

</body>
</html>